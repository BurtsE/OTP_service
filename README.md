
Backend-приложение, предназначенное для защиты действий пользователей с помощью одноразовых временных кодов (OTP). Цель сервиса — повысить безопасность при выполнении чувствительных операций, требующих подтверждения.

Основные возможности сервиса:
1. Создание защищённых операций — пользователи могут инициировать операции, которые будут защищены дополнительным уровнем подтверждения.

2. Генерация OTP-кодов — для каждой операции формируется уникальный одноразовый код, предназначенный для последующей проверки.

3. Доставка кодов — OTP-коды могут быть отправлены через различные каналы связи: SMS, Email или Telegram.

4. Проверка кодов — при подтверждении операции пользователь вводит полученный код, который система валидирует.

5. Гибкая настройка параметров — администратор может задавать длину OTP-кодов и срок их действия, адаптируя систему под требования безопасности.

# OTP API Documentation

Базовый адрес: `http://localhost:8080`

---

## Авторизация

Почти все эндпоинты (кроме `/login` и `/register`) требуют заголовок:

```
Authorization: Bearer <токен>
```

---

## Эндпоинты

### POST `/login`

**Описание:** Логин пользователя  
**Авторизация:** Не требуется

**Тело запроса:**
```json
{
  "username": "example",
  "password": "123"
}
```

---

### POST `/register`

**Описание:** Регистрация нового пользователя  
**Авторизация:** Не требуется

**Тело запроса:**
```json
{
  "username": "example",
  "password": "123",
  "admin": false,
  "phoneNumber": "+78005553535",
  "email": "example@gmail.com",
  "telegramUsername": "example"
}
```

---

### POST `/user/make_transaction`

**Описание:** Совершение транзакции пользователем  
**Авторизация:** Требуется

**Тело запроса:**
```json
{
  "amount": 89,
  "purchase": "shop"
}
```

---

### POST `/user/generate_otp`

**Описание:** Генерация OTP-кода по транзакции  
**Авторизация:** Требуется

**Тело запроса:**
```json
{
  "transactionId": "c64b4b05-3221-4636-b26a-4acfa141f4bb",
  "saveToFileOTP": true,
  "sendOTP": true
}
```

---

### POST `/user/validate_otp`

**Описание:** Валидация OTP-кода  
**Авторизация:** Требуется

**Тело запроса:**
```json
{
  "code": "3797064349"
}
```

---

### GET `/admin/users`

**Описание:** Получение списка всех пользователей  
**Авторизация:** Требуется (admin)

---

### DELETE `/admin/delete_users`

**Описание:** Удаление пользователей по логинам  
**Авторизация:** Требуется (admin)

**Тело запроса:**
```json
{
  "usernames": ["ex1", "ex2"]
}
```

---

### POST `/admin/otp_config_edit`

**Описание:** Изменение конфигурации OTP-кодов  
**Авторизация:** Требуется (admin)

**Тело запроса:**
```json
{
  "length": 10,
  "lifetime": 60
}
```

---

## Примечания

- Все запросы используют `application/json`.
- JWT-токены в примерах приведены для теста — заменяйте на актуальные.
- Уровень доступа `admin` требуется для всех `admin/*` маршрутов.

---



Для запуска проекта должна быть создана БД на Postgres, а также заполнены app.properties:
app.secret_key=секретный ключ (секрет) для создания и проверки JWT
app.ttlMillis=время жизни токена JWT в миллисекундах
app.period.scheduler.min=интервал работы шедулера по обновлению статусы истекших OTP-кодов
app.otp.lifetime.sec=время жизни OTP-кода в секундах по дефолту
app.otp.length=длина OTP-кода по дефолту
app.token_bot=токен телеграм-бота
app.port=порт запуска приложения
app.db.url=эндпоинт базы данных Постгрэс
app.db.user=логин пользователя базы данных Постгрэс
app.db.pass=пароль пользователя базы данных Постгрэс без шифрования